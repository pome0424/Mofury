<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Mofury Edge Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <h1>Mofury Edge Function Test</h1>
  <button onclick="testEdge()">テスト実行</button>

  <pre id="result"></pre>

<script>
/* ===============================
   ★ ここだけ自分のに置き換える
   =============================== */
const PROJECT_ID = "ruyvyedvdzyedafehhoz";
const ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1eXZ5ZWR2ZHp5ZWRhZmVoaG96Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NjM1NDEsImV4cCI6MjA4MTQzOTU0MX0.tr4v3-bmIEyZ_DRMXSpxdx-7ZGAGc2GRcSJaXKuJFSs";
/* =============================== */

async function testEdge() {
  const result = document.getElementById("result");
  result.textContent = "通信中…";

  try {
    const res = await fetch(
      `https://${PROJECT_ID}.supabase.co/functions/v1/scratch-auth-handler`,
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${ANON_KEY}`
        },
        body: JSON.stringify({ test: true })
      }
    );

    const text = await res.text();
    result.textContent =
      "status: " + res.status + "\n\n" + text;

  } catch (e) {
    result.textContent = "通信エラー\n" + e;
  }
}
</script>
</body>
</html>
